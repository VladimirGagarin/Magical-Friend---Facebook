function loadUserData(){const e=JSON.parse(localStorage.getItem("myself"));e?(document.getElementById("username").textContent=e.facebookName,document.getElementById("userImages").src=e.image,document.getElementById("userBio").textContent=`Bio: ${e.bio}`):window.location.href="index.html"}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("menu-toggle"),t=document.getElementById("nav"),n=document.querySelectorAll("#nav a"),o=document.querySelectorAll("section"),i=localStorage.getItem("activeSectionId"),a=n=>{n?(t.style.left="0",e.setAttribute("aria-expanded","true")):(t.style.left="-100%",e.setAttribute("aria-expanded","false"))};if(e.addEventListener("click",(function(){const t="true"===e.getAttribute("aria-expanded");a(!t)})),n.forEach((e=>{e.addEventListener("click",(function(t){t.preventDefault(),n.forEach((e=>e.classList.remove("active"))),e.classList.add("active");const i=e.getAttribute("href").substring(1),d=document.getElementById(i);o.forEach((e=>e.style.display="none")),d&&(d.style.display="flex",localStorage.setItem("activeSectionId",i),a(!1))}))})),i){const e=document.getElementById(i);e&&(o.forEach((e=>e.style.display="none")),e.style.display="flex",n.forEach((e=>{e.classList.remove("active"),e.getAttribute("href").substring(1)===i&&e.classList.add("active")})))}else{o.forEach((e=>e.style.display="none"));const e=document.querySelector("#home");e&&(e.style.display="flex",n.forEach((e=>{"home"===e.getAttribute("href").substring(1)&&e.classList.add("active")})))}})),window.addEventListener("beforeunload",(()=>{const e=document.querySelector("#nav a.active");if(e){const t=e.getAttribute("href").substring(1);localStorage.setItem("activeSectionId",t)}})),document.addEventListener("DOMContentLoaded",loadUserData),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("friendsContainer"),t=document.getElementById("viewOverlay"),n=document.getElementById("viewOptions"),o=document.getElementById("largeImage"),i=document.querySelector(".closeOverlay button"),a=document.getElementById("downloadButton");t.style.display="none",function(){const d=JSON.parse(localStorage.getItem("friends"));if(d&&d.length){if(d.length<5)return void(window.location.href="index.html");d.forEach(((d,l)=>{const r=function(e,t){const n=document.createElement("div");n.classList.add("friend");const o=document.createElement("div");o.classList.add("friend-front");const i=document.createElement("img");i.src=e.image,i.alt=`${e.name}'s image`,o.appendChild(i);const a=document.createElement("div");a.classList.add("friend-back");const d=document.createElement("p");return d.textContent=`Name: ${e.name}`,a.appendChild(d),n.appendChild(o),n.appendChild(a),n}(d);e.appendChild(r),r.addEventListener("click",(()=>{!function(e){n.innerHTML="",t.style.display="flex";["polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)","polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)","polygon(25% 0%, 75% 0%, 100% 25%, 100% 75%, 75% 100%, 25% 100%, 0% 75%, 0% 25%)","polygon(20% 0%, 80% 0%, 100% 20%, 100% 80%, 80% 100%, 20% 100%, 0% 80%, 0% 20%)","polygon(50% 0%, 80% 10%, 100% 35%, 100% 70%, 80% 90%, 50% 100%, 20% 90%, 0% 70%, 0% 35%, 20% 10%)","polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)","polygon(0% 0%, 100% 0%, 100% 75%, 75% 75%, 75% 100%, 50% 75%, 0% 75%)","polygon(25% 0%, 75% 0%, 100% 25%, 75% 50%, 100% 75%, 75% 100%, 25% 100%, 0% 75%, 25% 50%, 0% 25%)","polygon(50% 0%, 61% 35%, 100% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 0% 35%, 39% 35%)","polygon(0% 50%, 50% 0%, 100% 50%, 50% 100%)","polygon(0% 50%, 25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%)","polygon(0% 0%, 100% 0%, 100% 60%, 60% 100%, 40% 100%, 0% 60%)","polygon(50% 0%, 90% 15%, 100% 50%, 90% 85%, 50% 100%, 10% 85%, 0% 50%, 10% 15%)","polygon(50% 0%, 90% 10%, 100% 35%, 90% 70%, 50% 90%, 20% 70%, 0% 35%, 10% 10%)","polygon(0% 15%, 35% 0%, 65% 0%, 100% 15%, 100% 85%, 65% 100%, 35% 100%, 0% 85%)","polygon(50% 0%, 63% 25%, 95% 25%, 75% 45%, 85% 75%, 50% 55%, 15% 75%, 25% 45%, 5% 25%, 37% 25%)","polygon(50% 0%, 80% 10%, 95% 40%, 80% 70%, 50% 90%, 20% 70%, 5% 40%, 20% 10%)","polygon(50% 0%, 70% 15%, 95% 50%, 70% 85%, 50% 100%, 30% 85%, 5% 50%, 30% 15%)","polygon(50% 0%, 83% 12%, 100% 43%, 94% 78%, 68% 100%, 32% 100%, 6% 78%, 0% 43%, 17% 12%)","polygon(50% 20%, 90% 50%, 100% 80%, 50% 100%, 0% 80%)","polygon(25% 0%, 75% 0%, 100% 25%, 100% 75%, 75% 100%, 25% 100%, 0% 75%, 0% 25%)","polygon(0% 0%, 100% 0%, 100% 60%, 60% 100%, 40% 100%, 0% 60%)","polygon(0% 0%, 0% 100%, 25% 100%, 25% 25%, 75% 25%, 75% 75%, 25% 75%, 25% 100%, 100% 100%, 100% 0%)","polygon(20% 0%, 80% 0%, 100% 20%, 100% 20%, 52% 100%, 46% 100%, 0 20%, 0% 20%)","polygon(50% 20%, 90% 0, 100% 40%, 70% 100%, 50% 100%, 30% 100%, 0 40%, 10% 0)","polygon(52% 33%, 72% 17%, 87% 27%, 86% 44%, 65% 75%, 50% 100%, 34% 74%, 19% 46%, 19% 26%, 36% 15%)","polygon(10% 25%, 35% 25%, 35% 0%, 65% 0%, 65% 25%, 90% 25%, 90% 50%, 65% 50%, 65% 100%, 35% 100%, 35% 50%, 10% 50%)","polygon(3.769% 22.712%, 83.418% 63.141%, 78.396% 63.141%, 81.475% 65.574%, 81.475% 65.574%, 83.224% 67.202%, 84.584% 68.981%, 85.556% 70.873%, 86.139% 72.841%, 86.333% 74.847%, 86.139% 76.852%, 85.556% 78.819%, 84.584% 80.709%, 83.224% 82.486%, 81.475% 84.11%, 81.475% 84.11%, 80.475% 84.839%, 79.42% 85.492%, 78.318% 86.069%, 77.174% 86.568%, 75.993% 86.992%, 74.782% 87.338%, 73.547% 87.607%, 72.293% 87.8%, 71.026% 87.916%, 69.752% 87.954%, 69.752% 87.954%, 68.479% 87.916%, 67.211% 87.8%, 65.955% 87.607%, 64.717% 87.338%, 63.504% 86.992%, 62.321% 86.568%, 61.174% 86.069%, 60.07% 85.492%, 59.015% 84.839%, 58.014% 84.11%, 53.339% 80.416%, 53.339% 86.895%, 53.339% 86.895%, 53.122% 89.021%, 52.493% 91.038%, 51.488% 92.919%, 50.139% 94.636%, 48.481% 96.163%, 46.549% 97.472%, 44.375% 98.538%, 41.996% 99.332%, 39.443% 99.829%, 36.753% 100%, 36.753% 100%, 34.062% 99.829%, 31.51% 99.332%, 29.13% 98.537%, 26.957% 97.472%, 25.024% 96.162%, 23.366% 94.635%, 22.018% 92.918%, 21.012% 91.038%, 20.383% 89.021%, 20.166% 86.895%, 20.166% 80.428%, 15.507% 84.11%, 15.507% 84.11%, 14.506% 84.839%, 13.451% 85.492%, 12.347% 86.069%, 11.2% 86.568%, 10.017% 86.992%, 8.804% 87.338%, 7.566% 87.607%, 6.311% 87.8%, 5.043% 87.916%, 3.769% 87.954%, 3.769% 87.954%, 2.495% 87.916%, 1.229% 87.8%, -0.025% 87.607%, -1.261% 87.338%, -2.472% 86.992%, -3.652% 86.568%, -4.797% 86.069%, -5.899% 85.492%, -6.953% 84.839%, -7.954% 84.11%, -7.954% 84.11%, -9.703% 82.486%, -11.063% 80.709%, -12.034% 78.819%, -12.617% 76.852%, -12.812% 74.847%, -12.617% 72.841%, -12.034% 70.873%, -11.063% 68.981%, -9.703% 67.202%, -7.954% 65.574%, -4.874% 63.141%, -9.897% 63.141%, -9.897% 63.141%, -12.588% 62.969%, -15.141% 62.472%, -17.521% 61.676%, -19.694% 60.609%, -21.626% 59.298%, -23.284% 57.77%, -24.633% 56.053%, -25.638% 54.173%, -26.266% 52.159%, -26.483% 50.036%, -26.483% 50.036%, -26.266% 47.913%, -25.638% 45.898%, -24.632% 44.018%, -23.283% 42.301%, -21.626% 40.773%, -19.693% 39.462%, -17.52% 38.395%, -15.14% 37.6%, -12.588% 37.102%, -9.897% 36.93%, -1.697% 36.93%, -7.954% 31.987%, -7.954% 31.987%, -9.703% 30.362%, -11.063% 28.585%, -12.034% 26.693%, -12.617% 24.725%, -12.812% 22.719%, -12.617% 20.713%, -12.034% 18.745%, -11.063% 16.853%, -9.703% 15.076%, -7.954% 13.451%, -7.954% 13.451%, -5.898% 12.069%, -3.649% 10.995%, -1.254% 10.227%, 1.236% 9.766%, 3.776% 9.613%, 6.315% 9.766%, 8.806% 10.227%, 11.2% 10.995%, 13.449% 12.069%, 15.505% 13.451%, 20.164% 17.134%, 20.164% 13.166%, 20.164% 13.166%, 20.382% 11.039%, 21.011% 9.022%, 22.018% 7.142%, 23.369% 5.425%, 25.028% 3.898%, 26.961% 2.588%, 29.135% 1.523%, 31.514% 0.728%, 34.064% 0.232%, 36.75% 0.061%, 36.75% 0.061%, 39.437% 0.232%, 41.987% 0.729%, 44.366% 1.523%, 46.54% 2.589%, 48.473% 3.899%, 50.132% 5.426%, 51.483% 7.143%, 52.49% 9.023%, 53.119% 11.04%, 53.337% 13.166%, 53.337% 17.147%, 58.012% 13.453%, 58.012% 13.453%, 60.068% 12.071%, 62.317% 10.997%, 64.711% 10.229%, 67.202% 9.768%, 69.741% 9.615%, 72.28% 9.768%, 74.771% 10.229%, 77.165% 10.997%, 79.415% 12.071%, 81.471% 13.453%, 81.471% 13.453%, 83.219% 15.078%, 84.58% 16.855%, 85.551% 18.746%, 86.134% 20.715%, 86.328% 22.721%, 86.134% 24.727%, 85.551% 26.695%, 84.58% 28.587%, 83.219% 30.364%, 81.471% 31.989%, 75.214% 36.932%, 83.414% 36.932%, 83.414% 36.932%, 86.105% 37.104%, 88.657% 37.6%, 91.037% 38.395%, 93.211% 39.461%, 95.143% 40.77%, 96.801% 42.297%, 98.149% 44.015%, 99.155% 45.895%, 99.783% 47.912%, 100% 50.037%, 100% 50.037%, 99.783% 52.163%, 99.155% 54.18%, 98.149% 56.06%, 96.8% 57.778%, 95.142% 59.305%, 93.21% 60.614%, 91.037% 61.68%, 88.657% 62.475%, 86.104% 62.971%, 83.414% 63.143%, 3.769% 22.712%)","polygon(0% 15%, 15% 15%, 15% 0%, 85% 0%, 85% 15%, 100% 15%, 100% 85%, 85% 85%, 85% 100%, 15% 100%, 15% 85%, 0% 85%)","polygon(75% 0%, 100% 50%, 75% 100%, 0% 100%, 25% 50%, 0% 0%)","polygon(0 0, 100% 0, 51% 100%, 51% 100%)","polygon(100% 0%, 75% 50%, 100% 100%, 25% 100%, 0% 50%, 25% 0%)","polygon(20% 0%, 0% 20%, 30% 50%, 0% 80%, 20% 100%, 50% 70%, 80% 100%, 100% 80%, 70% 50%, 100% 20%, 80% 0%, 50% 30%)","polygon(0% 20%, 60% 20%, 60% 0%, 100% 50%, 60% 100%, 60% 80%, 0% 80%)","polygon(40% 0%, 40% 20%, 100% 20%, 100% 80%, 40% 80%, 40% 100%, 0% 50%)","polygon(25% 0%, 100% 0%, 75% 100%, 0% 100%)","polygon(50% 0%, 0% 100%, 100% 100%)","polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)","polygon(11% 20%, 35% 11%, 35% 0%, 70% 1%, 70% 25%, 70% 49%, 70% 49%, 69% 100%, 35% 100%, 34% 36%, 11% 40%)","polygon(6% 6%, 92% 97%, -1% 94%, 96% 1%)","polygon(75% 0%, 75% 50%, 75% 100%, 0% 100%, 25% 50%, 0% 0%)","polygon(75% 0%, 45% 50%, 75% 100%, 0% 100%, -2% 50%, 0% 0%)","polygon(100% -5%, -1% -2%, 1% 95%, 101% 96%, 43% 43%)","polygon(100% -5%, -1% -2%, 48% 42%, 0% 93%, 100% 92%)","polygon(68% 23%, 1% -1%, 8% 28%, 14% 63%, 98% 95%)","polygon(95% 0%, 22% 15%, 0% 95%, 0% 96%, 75% 61%)","polygon(50% 0%, 61% 16%, 80% 16%, 91% 29%, 100% 50%, 91% 71%, 80% 84%, 50% 100%, 20% 84%, 9% 71%, 0% 50%, 9% 29%, 20% 16%,39% 16%)","polygon( 50% 0%, 60% 10%, 70% 15%, 80% 25%, 85% 40%, 80% 55%, 70% 70%, 60% 80%, 50% 90%, 40% 80%, 30% 70%, 20% 55%, 15% 40%, 20% 25%, 30% 15%, 40% 10%","polygon(51% 24%, 60% 9%, 70% 4%, 85% 5%, 92% 12%, 93% 25%, 88% 40%, 83% 52%, 76% 62%, 66% 76%, 58% 86%, 49% 95%, 39% 83%, 30% 71%, 22% 59%, 15% 47%, 10% 36%, 9% 26%, 9% 16%, 16% 7%, 27% 5%, 36% 5%, 45% 10%)","polygon(94% 4%, 44% 32%, 4% 18%, 12% 71%, 83% 67%)","polygon(25% 0%, 100% 0%, 100% 100%, 25% 100%, 0% 50%)","polygon(0% 0%, 75% 0%, 100% 50%, 75% 100%, 0% 100%)","polygon(50% 0%, 100% 1%, 100% 35%, 100% 70%, 80% 90%, 50% 100%, 20% 90%, 0% 70%, 0% 35%, 0 0)","polygon(15% 16%, 35% 10%, 35% 0%, 65% 0%, 65% 25%, 65% 25%, 65% 50%, 65% 50%, 65% 85%, 35% 85%, 34% 34%, 15% 38%)","polygon(0% 0%,  100% 0%, 100% 20%, 20% 20%, 80% 80%, 0% 80%, 0% 100%, 100% 100%, 100% 80%, 20% 80%, 80% 20%, 0% 20%)","polygon(0% 15%, 1% 0, 15% 0%, 85% 0%, 100% 0, 100% 15%, 100% 85%, 73% 85%, 83% 100%, 15% 100%, 30% 85%, 0% 85%)","polygon(0 0, 100% 0, 100% 20%, 100% 80%, 100% 100%, 20% 100%, 0% 80%, 0% 20%)","polygon(0 0, 100% 0, 100% 41%, 100% 80%, 76% 100%, 0 100%, 0 80%, 0 43%)","polygon(0 0, 100% 0, 100% 41%, 100% 80%, 76% 100%, 0 100%, 0 80%, 0 43%)","polygon(0 0, 0 100%, 100% 1%, 100% 100%, 46% 56%)","polygon(35% 0, 35% 25%, 35% 0%, 65% 0%, 65% 25%, 64% 0, 90% 50%, 65% 50%, 65% 100%, 35% 100%, 35% 50%, 10% 50%)","polygon(0 51%, 0 25%, 0 0, 100% 0, 100% 26%, 100% 50%, 90% 50%, 65% 50%, 65% 100%, 35% 100%, 35% 50%, 7% 50%)","polygon(0 51%, 0 25%, 0 0, 100% 0, 100% 26%, 100% 50%, 100% 50%, 100% 100%, 50% 67%, 50% 67%, 0 100%, 0 49%)","polygon(1% 0, 35% 0, 35% 0%, 65% 0%, 65% 0, 100% 0, 100% 33%, 65% 33%, 65% 100%, 35% 100%, 36% 34%, 0 34%)","polygon(100% 1%, 52% 50%, 52% 0, 0 50%, 53% 100%, 52% 50%, 100% 100%)","polygon(0 0, 100% 45%, 100% 45%, 42% 100%, 100% 45%, 0 99%, 0 45%)","polygon(100% 0, 42% 52%, 0 55%, 100% 0, 100% 100%, 0 55%)","polygon(0 21%, 58% 51%, 60% 0%, 100% 50%, 60% 100%, 58% 51%, 0% 80%)","polygon(40% 0%, 42% 51%, 100% 0, 100% 100%, 42% 51%, 40% 100%, 0% 50%)","polygon(0 0, 61% 47%, 60% 0%, 100% 50%, 60% 100%, 61% 47%, 0 100%)","polygon(0 0, 61% 47%, 60% 0%, 100% 50%, 60% 100%, 61% 47%, 0 100%)","polygon(49% 0, 50% 50%, 100% 0, 100% 100%, 50% 50%, 48% 100%, 0% 50%)","polygon(100% 0%, 0 49%, 100% 50%, 0 100%, 0 49%, 100% 50%)","polygon(45% 21%, 40% 10%, 32% 6%, 17% 4%, 6% 7%, 0% 15%, 1% 27%, 6% 42%, 10% 51%, 16% 61%, 22% 71%, 30% 81%, 43% 95%, 55% 84%, 67% 71%, 75% 59%, 81% 50%, 88% 39%, 93% 27%, 93% 16%, 86% 6%, 70% 5%, 58% 7%, 50% 15%, 46% 28%)"].forEach(((t,i)=>{const a=document.createElement("div");a.classList.add("clip-path-option"),a.style.clipPath=t;const d=document.createElement("img");d.src=e.image,d.alt=`View ${i+1}`,d.style.clipPath=t,d.addEventListener("click",(()=>{var n,i;n=e.image,i=t,o.src=n,o.style.clipPath=i})),a.appendChild(d),n.appendChild(a)})),a.addEventListener("click",(()=>{!function(e,t,n){const o=document.createElement("canvas"),i=o.getContext("2d"),a=new Image;a.crossOrigin="anonymous",a.onload=function(){if(o.width=a.width,o.height=a.height,i.clearRect(0,0,o.width,o.height),t){const e=function(e,t,n){const o=new Path2D;if(e.startsWith("polygon")){const i=e.match(/\d+(\.\d+)?%/g).map((e=>parseFloat(e)/100));for(let e=0;e<i.length;e+=2){const a=i[e]*t,d=i[e+1]*n;0===e?o.moveTo(a,d):o.lineTo(a,d)}o.closePath()}else if(e.startsWith("circle")){const i=e.match(/circle\((\d+(\.\d+)?%) at (\d+(\.\d+)?%) (\d+(\.\d+)?%)\)/),a=parseFloat(i[1])/100*Math.min(t,n)/2,d=parseFloat(i[3])/100*t,l=parseFloat(i[5])/100*n;o.arc(d,l,a,0,2*Math.PI)}else if(e.startsWith("ellipse")){const i=e.match(/ellipse\((\d+(\.\d+)?%) (\d+(\.\d+)?%) at (\d+(\.\d+)?%) (\d+(\.\d+)?%)\)/),a=parseFloat(i[1])/100*t/2,d=parseFloat(i[2])/100*n/2,l=parseFloat(i[4])/100*t,r=parseFloat(i[6])/100*n;o.ellipse(l,r,a,d,0,0,2*Math.PI)}return o}(t,o.width,o.height);i.save(),i.beginPath(),i.clip(e),i.drawImage(a,0,0,o.width,o.height),i.restore()}else i.drawImage(a,0,0,o.width,o.height);o.toBlob((function(e){const t=document.createElement("a"),o=URL.createObjectURL(e);t.href=o,t.download=`Magical-Friend-${n.name}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(o)}),"image/png")},a.src=e}(o.src,o.style.clipPath,e)})),i.addEventListener("click",(()=>{t.style.display="none",o.src="logo.png"}))}(d)}))}))}else window.location.href="index.html"}()})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("viewOverlay");function t(){e.style.display="none"===e.style.display||""===e.style.display?"flex":"none"}document.querySelector(".closeOverlay button").addEventListener("click",t),e.addEventListener("click",(n=>{n.target===e&&t()}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("friendsContainer"),t=Array.from(e.children);function n(){t.forEach((e=>{const t=e.getBoundingClientRect();t.top<window.innerHeight&&t.bottom>0?e.classList.add("animate","visible"):e.classList.remove("animate","visible")}))}n(),window.addEventListener("scroll",n)})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("userCanvas"),t=e.getContext("2d");e.width=e.clientWidth,e.height=e.clientHeight;const n=[],o=["#ff00ff","#ff99ff","#cc00cc","#ff66ff","#ff33ff"];class i{constructor(e,t){this.x=e,this.y=t,this.size=2*Math.random()+1,this.speedX=3*Math.random()-1.5,this.speedY=3*Math.random()-1.5,this.color=o[Math.floor(Math.random()*o.length)]}update(){this.x+=this.speedX,this.y+=this.speedY,this.size>.1&&(this.size-=.01)}draw(){t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.closePath(),t.fill()}}setInterval((function(){const t=e.getBoundingClientRect(),o=Math.random()*t.width,a=Math.random()*t.height;for(let e=0;e<5;e++)n.push(new i(o,a))}),100),function o(){t.clearRect(0,0,e.width,e.height),function(){for(let e=0;e<n.length;e++)n[e].update(),n[e].draw(),n[e].size<=.1&&(n.splice(e,1),e--)}(),requestAnimationFrame(o)}()})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("magiic-2"),t=new THREE.Scene,n=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),o=new THREE.WebGLRenderer({canvas:e});o.setSize(window.innerWidth,window.innerHeight),n.position.z=10;const i=new THREE.TextureLoader,a=i.load("magic5.png"),d=i.load("logo.png"),l=i.load("heart.png"),r=[],c=[];function s(e,n){const o=new THREE.BoxGeometry(10,10,10),i=new THREE.MeshBasicMaterial({map:e}),a=new THREE.Mesh(o,i);return a.position.set(80*Math.random()-40,80*Math.random()-40,80*Math.random()-40),t.add(a),n?r.push(a):c.push(a),a}for(let e=0;e<20;e++)s(a,!0);for(let e=0;e<20;e++){const e=s(d,!1),t=r[Math.floor(Math.random()*r.length)];e.userData.targetCube=t}!function e(){c.forEach((e=>{const n=e.userData.targetCube;if(n){const o=new THREE.Vector3;o.subVectors(n.position,e.position).normalize(),e.position.add(o.multiplyScalar(.5));e.position.distanceTo(n.position)<5&&(!function(e){const n=new THREE.PlaneGeometry(6,6),o=new THREE.MeshBasicMaterial({map:l,transparent:!0}),i=new THREE.Mesh(n,o);i.position.copy(e),t.add(i),function e(){i.scale.x+=.1,i.scale.y+=.1,i.material.opacity-=.09,i.material.opacity<=0?(t.remove(i),setTimeout((()=>{r.forEach((e=>{e.material.color.setHex(16777215)})),c.forEach((e=>{e.material.color.setHex(16777215)}))}),2e3)):requestAnimationFrame(e)}()}(n.position),e.material.color.setHex(16711680),n.material.color.setHex(16711680),e.position.set(40*Math.random()-20,40*Math.random()-20,40*Math.random()-20),n.position.set(40*Math.random()-20,40*Math.random()-20,40*Math.random()-20))}})),setTimeout(e,500)}(),function e(){requestAnimationFrame(e),r.forEach((e=>{e.rotation.x+=.0095,e.rotation.y+=.0095})),c.forEach((e=>{e.rotation.x-=.0075,e.rotation.y-=.0075})),o.render(t,n)}(),window.addEventListener("resize",(()=>{o.setSize(window.innerWidth,window.innerHeight),n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix()}))}));const canvasMagic=document.getElementById("magiic-1"),sceneMagic=new THREE.Scene,cameraMagic=new THREE.PerspectiveCamera(75,canvasMagic.clientWidth/canvasMagic.clientHeight,.1,1e3),rendererMagic=new THREE.WebGLRenderer({canvas:canvasMagic});rendererMagic.setSize(canvasMagic.clientWidth,canvasMagic.clientHeight);const textureLoader=new THREE.TextureLoader,logoTexture=textureLoader.load("logo.png"),logoTwoTexture=textureLoader.load("magic5.png"),userImageUrl=JSON.parse(localStorage.getItem("myself")),userTexture=textureLoader.load(userImageUrl.image);function loadFriendTextures(){const e=[];return(JSON.parse(localStorage.getItem("friends"))||[]).forEach((t=>{const n=textureLoader.load(t.image);e.push(n)})),e}const friendTextures=loadFriendTextures();function createCube(e){const t=new THREE.BoxGeometry(.5,.5,.5),n=new THREE.MeshBasicMaterial({map:e}),o=new THREE.Mesh(t,n);return o.position.set(10*Math.random()-5,10*Math.random(),10*Math.random()-5),sceneMagic.add(o),o}function loadMagicScene(){sceneMagic.children=[];const e=[logoTexture,logoTwoTexture,userTexture,...friendTextures];for(let t=0;t<200;t++){createCube(e[Math.floor(Math.random()*e.length)])}!function e(){requestAnimationFrame(e),sceneMagic.children.forEach((e=>{e.rotation.x+=.01,e.rotation.y+=.01,e.position.y-=.05,e.position.y<-5&&(e.position.y=10*Math.random()+5,e.position.x=10*Math.random()-5,e.position.z=10*Math.random()-5)})),rendererMagic.render(sceneMagic,cameraMagic)}()}loadMagicScene(),window.addEventListener("resize",(()=>{const e=canvasMagic.clientWidth,t=canvasMagic.clientHeight;rendererMagic.setSize(e,t),cameraMagic.aspect=e/t,cameraMagic.updateProjectionMatrix();const n=Math.min(e,t)/600;sceneMagic.children.forEach((e=>{e.scale.set(n,n,n)}))}));let scrollOffset=0,previousScrollOffset=0;window.addEventListener("scroll",(()=>{scrollOffset=window.scrollY;const e=scrollOffset>previousScrollOffset?"down":"up";sceneMagic.children.forEach((t=>{"down"===e?t.position.y-=.05:t.position.y+=.09,t.position.y<-5&&(t.position.y=10*Math.random()+5,t.position.x=10*Math.random()-5,t.position.z=10*Math.random()-5)})),previousScrollOffset=scrollOffset})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".song-card"),t=document.getElementById("getUserSong"),n=document.getElementById("overlay"),o=document.getElementById("logo"),i=document.getElementById("userImage");let a=null;const d=JSON.parse(localStorage.getItem("myself")).image;function l(){n.classList.add("show-overlay"),o.style.animation="swapPosition 4s ease-in-out 0s 3 alternate both;",i.style.animation="swapPosition 4s infinite"}function r(){n.classList.remove("show-overlay"),o.style.animation="none",i.style.animation="none"}d?i.src=d:window.location.href="index.html",e.forEach((e=>{const t=e.querySelector(".details .deeper-details button:first-child"),n=e.querySelector("audio"),o=e.querySelector(".duration"),i=e.querySelector(".visualizer"),d=e.querySelector(".logo");if(n.addEventListener("waiting",l),n.addEventListener("stalled",l),n.addEventListener("playing",r),n.addEventListener("pause",r),n.addEventListener("ended",r),n.addEventListener("loadedmetadata",r),!(t&&n&&o&&i))return void console.error("One or more elements not found in song card:",e);const c=i.getContext("2d");let s,m,u,p,g=!1;t.addEventListener("click",(()=>{if(a&&a!==n){a.pause();const e=a.closest(".song-card");e.querySelector(".details .deeper-details button:first-child").innerHTML="&#9654;",e.classList.remove("playing");const t=e.querySelector(".logo");t&&(t.style.display="block"),e.querySelector(".visualizer").getContext("2d").clearRect(0,0,i.width,i.height),g=!1}n.paused?(n.play(),t.innerHTML="&#10073; &#10073;",a=n,e.classList.add("playing"),d.style.display="none",function(e,t){s=new(window.AudioContext||window.webkitAudioContext),m=s.createAnalyser();const n=s.createMediaElementSource(e);function o(){if(!a||a!==e)return;requestAnimationFrame(o),m.getByteFrequencyData(u),t.clearRect(0,0,i.width,i.height);const n=i.width/p*2.5;let d,l=0;for(let e=0;e<p;e++)d=u[e],t.fillStyle="rgb(0, 0, "+(d+100)+")",t.fillRect(l,i.height-d/2,n,d/2),l+=n+1}n.connect(m),m.connect(s.destination),m.fftSize=128,p=m.frequencyBinCount,u=new Uint8Array(p),o()}(n,c),g=!0):(n.pause(),t.innerHTML="&#9654;",a=null,e.classList.remove("playing"),d.style.display="block",i.getContext("2d").clearRect(0,0,i.width,i.height),g=!1)})),n.addEventListener("timeupdate",(()=>{o.innerHTML="&#9835; "+function(e){const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n<10?"0":""}${n}`}(n.currentTime)})),n.addEventListener("ended",(()=>{t.innerHTML="&#9654;",a=null,e.classList.remove("playing"),d.style.display="block",g=!1})),n.addEventListener("play",(()=>{e.classList.add("playing"),d.style.display="none",g=!0}))})),t.addEventListener("change",(e=>{const t=e.target.files[0];if(t){const e=URL.createObjectURL(t);!function(e,t){const n=document.getElementById("songs"),o=document.createElement("div");o.classList.add("song-card"),o.innerHTML=`\n            <div class="logo"></div>\n            <h3>${e}</h3>\n            <div class="song-audio">\n                <audio src="${t}"></audio>\n            </div>\n            <div class="duration">0:00</div>\n            <div class="details">\n                <div class="deeper-details">\n                    <div class="all-button-container">\n                        <button>&#9654;</button>\n                        <button>&#9655;</button>\n                        <button>Select</button>\n                    </div>\n                    <canvas class="visualizer"></canvas>\n                </div>\n            </div>\n        `,n.appendChild(o);const i=o.querySelector(".details .deeper-details button:first-child"),d=o.querySelector("audio"),l=o.querySelector(".duration"),r=o.querySelector(".visualizer"),c=o.querySelector(".logo");if(!(i&&d&&l&&r))return void console.error("One or more elements not found in newly created song card:",o);const s=r.getContext("2d");let m,u,p,g;function y(e,t){m=new(window.AudioContext||window.webkitAudioContext),u=m.createAnalyser();m.createMediaElementSource(e).connect(u),u.connect(m.destination),u.fftSize=128,g=u.frequencyBinCount,p=new Uint8Array(g),h()}function h(){if(!a)return;requestAnimationFrame(h),u.getByteFrequencyData(p),s.clearRect(0,0,r.width,r.height);const e=r.width/g*2.5;let t,n=0;for(let o=0;o<g;o++)t=p[o],s.fillStyle="rgb(0, 0, "+(t+100)+")",s.fillRect(n,r.height-t/2,e,t/2),n+=e+1}function E(e){const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n<10?"0":""}${n}`}i.addEventListener("click",(()=>{if(a&&a!==d){a.pause();const e=a.closest(".song-card");e.querySelector(".details .deeper-details button:first-child").innerHTML="&#9654;",e.classList.remove("playing");const t=e.querySelector(".logo");t&&(t.style.display="block")}d.paused?(d.play(),i.innerHTML="&#10073; &#10073;",a=d,o.classList.add("playing"),c.style.display="none",y(d,s)):(d.pause(),i.innerHTML="&#9654;",a=null,o.classList.remove("playing"),c.style.display="block")})),d.addEventListener("timeupdate",(()=>{l.textContent=E(d.currentTime)})),d.addEventListener("ended",(()=>{i.innerHTML="&#9654;",a=null,o.classList.remove("playing"),c.style.display="block"}))}(t.name,e);document.querySelector(".song-card:last-child").scrollIntoView({behavior:"smooth"})}}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".friends-view"),t=document.querySelector(".selected-song"),n=JSON.parse(localStorage.getItem("friends")),o=()=>{t.children.length<=1?document.querySelectorAll(".friend-checkbox").forEach((e=>{e.disabled=!0,e.style.display="none"})):document.querySelectorAll(".friend-checkbox").forEach((e=>{e.disabled=!1,e.style.display="block"}))};n&&Array.isArray(n)?n.forEach((n=>{const i=document.createElement("div");i.classList.add("friend-card"),i.innerHTML=`\n            <img src="${n.image}" alt="${n.name}"><br><input type="checkbox" class="friend-checkbox">`;const a=i.querySelector(".friend-checkbox");i.addEventListener("click",(()=>{a.checked=!a.checked,console.log(`Clicked on friend: ${n.name}`)})),e.appendChild(i),o(),t.addEventListener("DOMSubtreeModified",o)})):console.error("Friends data not found in localStorage")})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".selected-song");let t=null;const n=document.querySelector("#slideshows h4"),o=document.querySelector(".loading-indicator"),i=()=>{o.style.display="block"},a=()=>{o.style.display="none"};a();const d=()=>{e.children.length<=1?(n.style.display="block",document.querySelectorAll("#slideshow-1 button").forEach((e=>e.disabled=!0))):(n.style.display="none",document.querySelectorAll("#slideshow-1 button").forEach((e=>e.disabled=!1)))};d(),e.addEventListener("DOMSubtreeModified",d),document.addEventListener("click",(n=>{const o=n.target.closest(".song-card button:nth-of-type(3)");if(!o)return;if(o.classList.contains("selected"))return;const l=o.closest(".song-card"),r=l.querySelector("audio");t&&(t.pause(),t.currentTime=0);const c=document.createElement("div");c.classList.add("song-carded");const s=document.createElement("h3");s.textContent=l.querySelector("h3").textContent;const m=document.createElement("audio");m.src=r.src,m.controls=!1,m.addEventListener("waiting",i),m.addEventListener("stalled",i),m.addEventListener("playing",a),m.addEventListener("pause",a),m.addEventListener("ended",a),m.addEventListener("loadedmetadata",a),m.addEventListener("canplay",a),m.addEventListener("canplaythrough",a);const u=document.createElement("div");u.classList.add("detail");const p=document.createElement("div");p.classList.add("deeper-details");const g=document.createElement("button");g.innerHTML="&#9655;",g.classList.add("play-button"),g.addEventListener("click",(()=>{if(m.paused){if(t&&t!==m){t.pause(),t.currentTime=0;const e=t.closest(".song-carded").querySelector(".play-button");e&&(e.innerHTML="&#9655;")}m.play(),g.innerHTML="&#10073; &#10073;",t=m}else m.pause(),g.innerHTML="&#9655;"})),m.addEventListener("ended",(()=>{g.innerHTML="&#9655;"}));const y=document.createElement("div");y.classList.add("del-pick-container");const h=document.createElement("button");h.classList.add("delete-button"),h.innerHTML="🗑️",h.addEventListener("click",(()=>{c.remove(),o.classList.remove("selected"),o.innerHTML="Select",o.disabled=!1,d()}));const E=document.createElement("input");E.type="checkbox",E.classList.add("pickButton"),c.addEventListener("click",(e=>{e.target.classList.contains("play-button")||e.target.classList.contains("delete-button")||(E.checked=!E.checked)})),p.appendChild(g),u.appendChild(p),c.appendChild(s),c.appendChild(m),c.appendChild(u),y.appendChild(h),y.appendChild(E),c.appendChild(y),e.appendChild(c),d(),o.classList.add("selected"),o.innerHTML="&#9989; Selected",o.disabled=!0}))})),document.addEventListener("DOMContentLoaded",(()=>{let e=null;const t=(t,n)=>{document.querySelectorAll(".song-card audio").forEach((e=>{e.paused||(e.pause(),e.currentTime=0,e.closest(".song-card").querySelector(".all-button-container button:nth-of-type(1)").innerHTML="&#9654;")}));const o=document.createElement("div");o.classList.add("try-slideshow-overlay");const i=document.createElement("div");i.classList.add("trial-content");for(let e=0;e<3;e++){const t=document.createElement("div");t.classList.add("trial-div"),t.style.animationDelay=0*e+"s",i.appendChild(t)}const a=document.createElement("button");a.classList.add("trial-close"),a.innerText="X",a.addEventListener("click",(()=>{clearInterval(m),u.pause(),u.currentTime=0,o.remove()})),i.appendChild(a);const d=document.createElement("div");d.classList.add("trial-visualizer"),o.appendChild(d),o.appendChild(i),document.body.appendChild(o);let l=0;const r=document.querySelectorAll(".trial-div"),c=["animation-1","animation-2","animation-3","animation-4","animation-5","animation-6","animation-7","animation-8","animation-9","animation-10"],s=()=>{const e=c[Math.floor(Math.random()*c.length)];r.forEach(((n,o)=>{n.classList.remove(...c),n.classList.add(e),n.style.backgroundImage=`url(${t[l%t.length]})`,n.classList.remove("grayscale")})),r.forEach(((e,t)=>{setTimeout((()=>{e.classList.add("grayscale"),setTimeout((()=>{e.classList.remove("grayscale")}),3e3)}),3e3*t)}))};s();const m=setInterval((()=>{l++,s(),l>=3*t.length&&(clearInterval(m),setTimeout((()=>{u.pause(),u.currentTime=0,o.remove()}),8e3))}),8e3),u=new Audio(n);e=u,u.play(),u.addEventListener("ended",(()=>{clearInterval(m),setTimeout((()=>{o.remove()}),3e3)}));const p=new(window.AudioContext||window.webkitAudioContext),g=p.createAnalyser();p.createMediaElementSource(u).connect(g),g.connect(p.destination);const y=g.frequencyBinCount,h=new Uint8Array(y),E=()=>{requestAnimationFrame(E),g.getByteFrequencyData(h),d.innerHTML="";const e=100/y*2.5;let t,n=0;for(let o=0;o<y;o++){t=h[o]/2;const i=document.createElement("div");i.classList.add("visualizer-bar"),i.style.width=`${e}%`,i.style.height=`${t}px`,i.style.left=`${n}%`,d.appendChild(i),n+=e+.1}};E()};document.addEventListener("click",(e=>{const n=e.target.closest(".all-button-container button:nth-of-type(2)");if(n){const e=n.closest(".song-card").querySelector("audio").src,o=JSON.parse(localStorage.getItem("friends")).map((e=>e.image));t(o,e)}}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("slide-friends"),t=document.querySelector(".selected-song"),n=document.querySelectorAll(".friend-card");e.addEventListener("click",(()=>{t.scrollIntoView({behavior:"smooth"});t.querySelectorAll(".song-carded").forEach((e=>{const t=e.querySelector('input[type="checkbox"]'),n=e.querySelector("audio"),o=e.querySelector(".play-button");t&&(t.checked=!1),n&&(n.pause(),n.currentTime=0,n.loop=!1),o&&(o.innerHTML="&#9655;")})),n.forEach((e=>{const t=e.querySelector('input[type="checkbox"]');t&&(t.checked=!1,t.style.display="none")}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("done-button"),t=document.getElementById("pal-name"),n=document.getElementById("friend-heading"),o=document.querySelector(".font-picker").querySelectorAll(".font-option");let i="Impact";const a=document.querySelector(".file-label"),d=document.getElementById("add-image"),l=document.getElementById("preview-image"),r=JSON.parse(localStorage.getItem("friends"))||[{name:"Dwayne Joseph",img:"logo.ng"},{name:"Lydia Hialy",img:"logo.png"},{name:"Vin Mulinka",img:"logo.png"}],c=(o,i)=>{const d=document.querySelectorAll(".pal");o.classList.contains("selected")?(d.forEach((e=>{e.classList.remove("disabled")})),o.classList.remove("selected"),t.textContent="",n.textContent="Select one friend",e.disabled=!0,a.classList.remove("disabled")):(d.forEach((e=>{e!==o&&e.classList.add("disabled")})),o.classList.add("selected"),t.textContent=i,n.textContent="One word that describes your friend",e.disabled=!1,a.classList.add("disabled"))},s=()=>{const e=document.getElementById("word-input").value.toUpperCase().replace(/[^\w\s]/gi,""),t=document.getElementById("error-message"),n=document.getElementById("done-button"),a=document.getElementById("word-input");if(a.addEventListener("input",(()=>{""===a.value.trim()?(t.textContent="Please enter a word.",t.style.display="block",n.disabled=!0):(t.style.display="none",n.disabled=!1)})),a.addEventListener("keydown",(e=>{"Enter"===e.code&&(e.preventDefault(),s())})),0===e.trim().length)return t.textContent="Please enter a word.",t.style.display="block",void(n.disabled=!0);if(t.style.display="none",n.disabled=!1,e.length>25)return t.textContent="The word should be 25 characters or less and without punctuation.",t.style.display="block",void(n.disabled=!0);t.style.display="none";const d=document.querySelector(".pal.selected"),l=document.getElementById("preview-image").querySelector("img");if(!d&&!l)return t.textContent="Please select a friend.",t.style.display="block",void(n.disabled=!0);t.style.display="none";const r=d?d.querySelector("img").src:l.src,c=document.getElementById("output");c.innerHTML="",o.forEach((e=>{e.addEventListener("click",(()=>{i=e.dataset.font,o.forEach((e=>e.classList.remove("selected"))),e.classList.add("selected")}))}));for(let t of e){const e=document.createElement("div");e.className="letter",e.textContent=t,e.style.backgroundImage=`url(${r})`,e.style.fontFamily=i,c.appendChild(e)}const u=document.createElement("button");u.id="download-buttoned",u.textContent="Download Magic",u.addEventListener("click",m),c.appendChild(u)},m=()=>{const e=document.querySelector(".pal.selected"),t=document.getElementById("preview-image").querySelector("img"),n=e?e.querySelector("img").src:t.src;if(!(t&&"#"!==t.src||e))return void console.error("No image selected or invalid image source.");const o=document.getElementById("download-buttoned");o.disabled=!0,o.textContent="Hold on",o.classList.add("disabled");const a=new Image;a.crossOrigin="Anonymous",a.onload=()=>{const e=document.getElementById("output"),t=Array.from(e.getElementsByClassName("letter")),n=t.reduce(((e,t)=>e+1.2*t.offsetWidth+10),0),d=1.5*t[0].offsetHeight,l=document.createElement("canvas"),r=l.getContext("2d");l.width=n,l.height=d,l.classList.add("canvas-bg"),l.dataset.type="blackBg",r.fillStyle="black",r.fillRect(0,0,l.width,l.height);const c=document.createElement("canvas"),s=c.getContext("2d");c.width=n,c.height=d,c.classList.add("canvas-bg"),c.dataset.type="noOutline",s.fillStyle="white",s.fillRect(0,0,c.width,c.height);const m=document.createElement("canvas"),u=m.getContext("2d");m.width=n,m.height=d,m.classList.add("canvas-bg"),m.dataset.type="imageBg",u.drawImage(a,0,0,m.width,m.height);let p=0;t.forEach(((e,t)=>{const n=document.createElement("canvas"),m=n.getContext("2d"),g=1.2*e.offsetWidth+10;n.width=g,n.height=d;try{m.drawImage(a,0,0,n.width,n.height);const t="bolder";m.font=`${t} 80px ${i}`,m.textAlign="center",m.textBaseline="middle",n===l?m.fillText(e.textContent,n.width/2,n.height/2):n===c?(m.strokeStyle="white",m.lineWidth=2,m.strokeText(e.textContent,n.width/2,n.height/2)):(m.strokeStyle="black",m.lineWidth=2,m.strokeText(e.textContent,n.width/2,n.height/2),m.globalCompositeOperation="destination-in",m.fillText(e.textContent,n.width/2,n.height/2)),m.globalCompositeOperation="destination-in",m.fillText(e.textContent,n.width/2,n.height/2),m.shadowColor="rgba(0, 0, 0, 0.9)",m.shadowOffsetX=1,m.shadowOffsetY=1,m.shadowBlur=2,r.drawImage(n,p,0),u.drawImage(n,p,0),s.drawImage(n,p,0),p+=g}catch(e){console.error("DOMException while drawing:",e.message),o.textContent="Try again later",o.disabled=!0}}));const g=document.createElement("div");g.classList.add("confirm-overlayed");const y=document.createElement("button");y.innerHTML="&times;",y.classList.add("close-button"),y.addEventListener("click",(()=>{g.remove()})),g.appendChild(y);const h=document.createElement("div"),E=new Image;E.src=l.toDataURL("image/png"),h.appendChild(E);const f=document.createElement("button");f.textContent="Download.",f.addEventListener("click",(()=>{const e=document.createElement("a");e.download="magic-word.png",e.href=l.toDataURL("image/png"),e.click(),g.remove()})),h.appendChild(f),g.appendChild(h);const v=document.createElement("div"),w=new Image;w.src=m.toDataURL("image/png"),v.appendChild(w);const L=document.createElement("button");L.textContent="Download.",L.addEventListener("click",(()=>{const e=document.createElement("a");e.download="magic-word-withbg.png",e.href=m.toDataURL("image/png"),e.click(),g.remove()})),v.appendChild(L),g.appendChild(v);const x=document.createElement("div"),S=new Image;S.src=c.toDataURL("image/png"),x.appendChild(S);const T=document.createElement("button");T.textContent="Download.",T.addEventListener("click",(()=>{const e=document.createElement("a");e.download="shaped-text-no-outline.png",e.href=c.toDataURL("image/png"),e.click(),g.remove()})),x.appendChild(T),g.appendChild(x),document.body.appendChild(g),o.disabled=!1,o.classList.remove("disabled"),setTimeout((()=>{o.textContent="Download Magic Word"}),5e3)},a.onerror=e=>{console.error("Error loading friend image:",e),o.textContent="Try again later",o.disabled=!1},a.src=n};document.getElementById("done-button").addEventListener("click",s),d.addEventListener("change",(e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=function(e){const t=new Image;t.src=e.target.result,t.onload=function(){l.style.display="block",l.innerHTML="",l.appendChild(t),s()}},e.readAsDataURL(t)}})),o.forEach((e=>{e.addEventListener("click",(()=>{i=e.dataset.font,o.forEach((e=>e.classList.remove("selected"))),e.classList.add("selected")}))})),(()=>{const e=document.querySelector(".list-of-pals");e.innerHTML="",r.forEach((t=>{const n=document.createElement("div");n.className="pal",n.innerHTML=`<img src="${t.image}" alt="${t.name}"><span>${t.name}</span>`,n.addEventListener("click",(()=>c(n,t.name))),e.appendChild(n)}))})()})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("myCanvas"),t=new THREE.WebGLRenderer({canvas:e}),n=new THREE.Scene,o=new THREE.PerspectiveCamera(75,e.clientWidth/e.clientHeight,.1,1e3);o.position.z=5;const i=JSON.parse(localStorage.getItem("friends"))||[],a=JSON.parse(localStorage.getItem("myself")),d=a.image||"logo2.png",l={Joyful:"😊",Grateful:"🙏",Excited:"😃",Inspired:"🌟",Supportive:"🤝",Amused:"😂",Comforted:"🤗",Appreciative:"👍",Lovely:"💖",Cherished:"💝",Happy:"😁"};const r=[],c=4,s=5,m=`Art by ${a.facebookName}`;let u,p=!1;const g=(new THREE.TextureLoader).load("magic5.png"),y=new THREE.BoxGeometry(c,c,c),h=new THREE.MeshBasicMaterial({map:g}),E=new THREE.Mesh(y,h);E.position.x=-r.length*s,r.push(E),n.add(E);const f=new THREE.CanvasTexture(te("Magical Friend")),v=new THREE.BoxGeometry(c,c,c),w=new THREE.MeshBasicMaterial({map:f,color:"white"}),L=new THREE.Mesh(v,w);L.position.x=-r.length*s,r.push(L),n.add(L);const x=new THREE.CanvasTexture(te("Presents")),S=new THREE.BoxGeometry(c,c,c),T=new THREE.MeshBasicMaterial({map:x,color:"red"}),M=new THREE.Mesh(S,T);M.position.x=-(r.length*s+c),r.push(M),n.add(M);const C=new THREE.CanvasTexture(te(m)),b=new THREE.BoxGeometry(c,c,c),I=new THREE.MeshBasicMaterial({map:C,color:"white"}),B=new THREE.Mesh(b,I);B.position.x=-(r.length*s+c),r.push(B),n.add(B);const H=(new THREE.TextureLoader).load(d),k=new THREE.BoxGeometry(c,c,c),R=new THREE.MeshBasicMaterial({map:H}),q=new THREE.Mesh(k,R);q.position.x=-(r.length*s+c),r.push(q),n.add(q),i.forEach(((e,t)=>{const o=e.image,i=e.emotion||"Just a Friend",a=`${e.name}\n${function(e){const t=e.trim().toLowerCase(),n=Object.keys(l).find((e=>e.toLowerCase()===t));return n?`${l[n]} ${n} ${l[n]}`:"🙂 Just a Friend 🙂"}(i)}`,d=new THREE.CanvasTexture(function(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=512,t.height=512,n.fillStyle="#007bff",n.fillRect(0,0,t.width,t.height),n.fillStyle="white",n.font="bold 48px Comic Sans MS",n.textAlign="center",n.textBaseline="middle";const o=10;n.lineWidth=o,n.strokeStyle="white",n.strokeRect(0,0,t.width,t.height);const i=t.width-2*o,a=ne(n,e,i),d=60;return a.forEach(((e,o)=>{n.fillText(e,t.width/2,t.height/2-a.length/2*d+o*d)})),t}(a)),m=new THREE.BoxGeometry(c,c,c),u=new THREE.MeshBasicMaterial({map:d}),p=new THREE.Mesh(m,u);p.position.x=-(r.length*s+c),r.push(p),n.add(p);const g=(new THREE.TextureLoader).load(o),y=new THREE.BoxGeometry(c,c,c),h=new THREE.MeshBasicMaterial({map:g}),E=new THREE.Mesh(y,h);E.position.x=-(r.length*s+c),r.push(E),n.add(E)}));const A=(new THREE.TextureLoader).load("logo.png"),O=new THREE.BoxGeometry(c,c,c),D=new THREE.MeshBasicMaterial({map:A}),P=new THREE.Mesh(O,D);P.position.x=-(r.length*s+c),r.push(P),n.add(P);const $=`Top ${i.length} friends. of ${a.facebookName}`,F=new THREE.CanvasTexture(function(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=512,t.height=512,n.fillStyle="#007bff",n.fillRect(0,0,t.width,t.height),n.fillStyle="white",n.font='48px "Comic Sans MS", cursive, sans-serif',n.textAlign="center",n.textBaseline="middle";n.lineWidth=10,n.strokeStyle="white",n.strokeRect(0,0,t.width,t.height);const o=t.width-20,i=ne(n,e,o);return i.forEach(((e,o)=>{n.fillText(e,t.width/2,t.height/2-i.length/2*60+60*o)})),t}($)),N=new THREE.BoxGeometry(c,c,c),U=new THREE.MeshBasicMaterial({map:F,color:"gold"}),z=new THREE.Mesh(N,U);z.position.x=-(r.length*s+c),r.push(z),n.add(z),window.addEventListener("resize",(function(){o.aspect=e.clientWidth/e.clientHeight,o.updateProjectionMatrix(),t.setSize(e.clientWidth,e.clientHeight)}));let W=null;const G=.02;let J=[],j=new Audio("y2mate.com - Hans Zimmer  Reunion Love Found Us.mp3");function V(){W=requestAnimationFrame(V);const i=document.querySelector(".overlay-counter"),d=window.getComputedStyle(i),l=performance.now();J.push(l),r.forEach((e=>{e.position.x+=G})),t.render(n,o),u&&u.capture(e),Math.abs(z.position.x)<G&&(cancelAnimationFrame(W),W=null,ee(),Y.innerHTML="&#9655;",p||(!function(){const e=document.getElementById("downloaddiv"),t=document.getElementById("logoImage"),n=document.getElementById("userphoto"),o=document.getElementById("downloadButtoned"),i=document.getElementById("closeButton"),a=document.getElementById("agreeCheckbox"),d=document.getElementById("userNames"),l=JSON.parse(localStorage.getItem("myself"));l&&l.image?n.src=l.image:n.src="logo.png";l&&l.facebookName?d.textContent=l.facebookName:d.textContent="Lorem Ipsum";t.src="magic5.png",e.style.display="flex",a.addEventListener("change",(function(){a.checked?(o.disabled=!1,agreeLabel.textContent="Agreed",agreeLabel.style.color="gold"):(o.disabled=!0,agreeLabel.innerHTML='<input type="checkbox" id="agreeCheckbox"> I agree',document.getElementById("agreeCheckbox").addEventListener("change",this))})),o.addEventListener("click",(function(){if(!o.disabled){document.querySelector(".progressText").innerHTML+=`<p>Thankyou, ${l.facebookName} for being with Magical Friend</p>`,e.style.display="none",function(){const e=document.querySelector(".overlay-counter");e.style.display="flex"}(),u=new CCapture({format:"webm",framerate:60,verbose:!0,quality:100}),u.start(),oe(),V(),Q(),Y.innerHTML="&#9723;"}})),i.addEventListener("click",(function(){e.style.display="none"}))}(),p=!0),"flex"===d.getPropertyValue("display")&&(ie(),ee()),u&&(u.stop(),u.save((e=>{const t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`magical_friend_${a.facebookName} _video.webm`,t.click(),function(e){const t=document.createElement("div");t.id="showVideoOverlay",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.zIndex="1000",t.style.backgroundColor="rgba(0, 0, 0, 0.8)",t.style.padding="20px",t.style.borderRadius="10px",t.style.textAlign="center";const n=document.createElement("video");n.controls=!0,n.src=URL.createObjectURL(e),n.style.width="100%",n.style.maxWidth="600px",n.style.borderRadius="10px";const o=document.createElement("button");o.textContent="Close",o.style.marginTop="10px",o.addEventListener("click",(function(){document.body.removeChild(t)})),t.appendChild(n),t.appendChild(o),document.body.appendChild(t)}(e),ie()})),u=null,cancelAnimationFrame(W)),j.currentTime=30)}const Y=document.getElementById("magic-play");j.loop=!0;let _=!1,X=!1,K=0,Z=!1;function Q(e=!1){j.currentTime=e?30:K,j.play(),_=!0}function ee(){K=j.currentTime,j.pause(),_=!1}function te(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=512,t.height=512,n.fillStyle="#007bff",n.fillRect(0,0,t.width,t.height),n.fillStyle="white",n.font="bold 48px Comic Sans MS",n.textAlign="center",n.textBaseline="middle";n.lineWidth=10,n.strokeStyle="white",n.strokeRect(0,0,t.width,t.height);const o=t.width-20,i=ne(n,e,o);return i.forEach(((e,o)=>{n.fillText(e,t.width/2,t.height/2-i.length/2*60+60*o)})),t}function ne(e,t,n){const o=t.split(" ");let i=[],a=o[0];for(let t=1;t<o.length;t++){const d=o[t];e.measureText(a+" "+d).width<n?a+=" "+d:(i.push(a),a=d)}return i.push(a),i}function oe(){r.forEach(((e,t)=>{e.position.x=-(t*s+c)})),K=0,j.currentTime=30,Z=!1}function ie(){document.querySelector(".overlay-counter").style.display="none"}Y.addEventListener("click",(function(){r.some((e=>0!==e.position.x))?(W?(cancelAnimationFrame(W),W=null,ee(),Y.innerHTML="&#9654;"):(Math.abs(z.position.x)<G&&oe(),X?(V(),Q(!Z),Y.innerHTML="&#9723;"):(j.addEventListener("loadedmetadata",(function(){X=!0,Q(!Z),V(),Y.innerHTML="&#9723;"})),j.load())),Z=!0):location.reload()})),j.addEventListener("stalled",(function(){W&&(cancelAnimationFrame(W),W=null,Y.innerHTML="&#9655;")})),window.addEventListener("blur",(function(){W&&(cancelAnimationFrame(W),W=null,ee(),Y.innerHTML="&#9655;",u.stop(),j.pause())})),window.addEventListener("focus",(function(){!W&&_&&(V(),Y.innerHTML="&#9723;",u.start(),Q(!Z))}))})),document.addEventListener("DOMContentLoaded",(function(){var e,t,n=document.getElementById("memoriesCalendar"),o=document.getElementById("eventsCalendar"),i=document.getElementById("customPromptModal"),a=document.getElementById("customPromptInput"),d=document.getElementById("customPromptConfirm"),l=document.getElementById("customPromptCancel"),r=document.querySelector(".memory-title"),c=document.getElementById("memoryInput"),s=document.getElementById("saveMemory"),m=document.getElementById("memoriesList"),u=document.getElementById("owner-names"),p=!0;(JSON.parse(localStorage.getItem("memories"))||[]).forEach((function(e){var t=document.createElement("div");t.classList.add("memory-item");var n=document.createElement("h4");n.textContent=e.title,t.appendChild(n);var o=document.createElement("p");o.textContent=e.content,t.appendChild(o);var i=document.createElement("p");i.textContent="Memory Day: "+e.date,t.appendChild(i);var a=(new Date).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),d=document.createElement("p");d.textContent="Updated: "+(new Date).toLocaleDateString()+", "+a,t.appendChild(d);const l=document.createElement("div");l.classList.add("edit-container"),t.appendChild(l);var r=document.createElement("span");r.innerHTML="✏️",r.classList.add("edit-icon"),r.addEventListener("click",(function(){v("edit "+e.title)})),l.appendChild(r);var c=document.createElement("span");c.innerHTML="🗑️",c.classList.add("delete-icon"),c.addEventListener("click",(function(){v("delete "+e.title)})),l.appendChild(c),m.appendChild(t)}));var g=JSON.parse(localStorage.getItem("myself"));function y(n,o){i.style.display="flex",a.value="",a.focus(),e=n,t=o,p=!1}function h(){i.style.display="none",e=null,t=null}u.textContent=g.facebookName,d.addEventListener("click",(function(){var n=a.value.trim(),o=e.start.toLocaleDateString("en-US");n&&e&&t&&(t.addEvent({title:n,start:e.startStr,end:e.endStr,allDay:e.allDay}),r.innerHTML=o+" "+n),h()})),l.addEventListener("click",(function(){h(),p=!0}));var E=new FullCalendar.Calendar(n,{initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},selectable:!0,select:function(e){p&&new Date(e.startStr)<=new Date&&y(e,E)},events:[]}),f=new FullCalendar.Calendar(o,{initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},selectable:!0,select:function(e){new Date(e.startStr)>=new Date&&y(e,f)},events:[]});function v(e){var t=document.getElementById("confirmText"),n=document.getElementById("confirm-overlay"),o=document.getElementById("memoriesList"),i=JSON.parse(localStorage.getItem("memories"))||[];t.textContent=`Are you sure you want to ${e} this memory?`,n.style.display="block",e.trim().startsWith("delete")?document.getElementById("confirmYes").onclick=function(){var t=e.replace("delete ",""),a=Array.from(o.getElementsByClassName("memory-item")).find((function(e){return e.querySelector("h4").textContent===t}));a&&o.removeChild(a),i=i.filter((function(e){return e.title!==t})),localStorage.setItem("memories",JSON.stringify(i)),n.style.display="none"}:e.trim().startsWith("edit")&&(document.getElementById("confirmYes").onclick=function(){var t=e.replace("edit ",""),a=i.find((function(e){return e.title===t}));if(a){var d=document.createElement("div");d.classList.add("edit-form"),d.innerHTML=`\n                     <input type="text" id="editMemoryTitle" value="${a.title}">\n                    <textarea id="editMemoryContent">${a.content}</textarea>\n                    <label for="editMemoryDate">Memory Date:</label>\n                    <input type="date" id="editMemoryDate" value="${a.date}" max="${(new Date).toISOString().split("T")[0]}">\n                    <button id="editMemorySave">Save</button>\n                    <button id="editMemoryCancel">Cancel</button>\n                    <span class="edit-close">&times;</span>\n                `,document.body.appendChild(d),document.getElementById("editMemorySave").onclick=function(){a.title=document.getElementById("editMemoryTitle").value.trim(),a.content=document.getElementById("editMemoryContent").value.trim();var e=Array.from(o.getElementsByClassName("memory-item")).find((function(e){return e.querySelector("h4").textContent===t}));e&&(e.querySelector("h4").textContent=a.title,e.querySelector("p").textContent=a.content,e.querySelector("p:nth-child(3)").innerHTML=`<strong>Memory Day:</strong> ${a.date}`),localStorage.setItem("memories",JSON.stringify(i)),d.remove(),n.style.display="none"},document.getElementById("editMemoryCancel").onclick=function(){d.remove(),n.style.display="none"},d.querySelector(".edit-close").onclick=function(){d.remove(),n.style.display="none"}}}),document.getElementById("confirmNo").onclick=function(){n.style.display="none"}}E.render(),f.render(),c.addEventListener("input",(function(){s.disabled=!c.value.trim()})),document.getElementById("saveMemory").addEventListener("click",(function(){var e,t,n,o,i,a=c.value.trim(),d=r.textContent.trim(),l=r.textContent.trim(),u=l.indexOf(" "),g=(d=l.substring(0,u),l.substring(u+1));if(a&&d){var y=document.createElement("div");y.classList.add("memory-item");var h=document.createElement("h4");h.textContent=g,y.appendChild(h);var E=document.createElement("p");E.textContent=a,y.appendChild(E);var f=document.createElement("p");f.innerHTML="<strong>Memory Day:</strong> "+d,y.appendChild(f);var w=(new Date).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),L=document.createElement("p");L.innerHTML="<b>Updated:</b> "+(new Date).toLocaleDateString()+", "+w,y.appendChild(L);const l=document.createElement("div");l.classList.add("edit-container"),y.appendChild(l);var x=document.createElement("span");x.innerHTML="✏️",x.classList.add("edit-icon"),l.appendChild(x),x.addEventListener("click",(function(){v("edit "+g)}));var S=document.createElement("span");S.innerHTML="🗑️",S.classList.add("delete-icon"),l.appendChild(S),S.addEventListener("click",(function(){v("delete "+g)})),m.appendChild(y),c.value="",r.textContent="",s.disabled=!0,p=!0,e=d,t=g,n=a,o=JSON.parse(localStorage.getItem("memories"))||[],i={date:e,title:t,content:n},o.push(i),localStorage.setItem("memories",JSON.stringify(o)),window.location.reload()}})),document.getElementById("setReminder").addEventListener("click",(function(){var e=document.getElementById("reminderText").value,t=document.getElementById("reminderDate").value;if(e&&t){var n=document.createElement("div");n.textContent=e+" - "+new Date(t).toLocaleString(),document.getElementById("alertsList").appendChild(n),document.getElementById("reminderText").value="",document.getElementById("reminderDate").value=""}})),h()})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("grid-memories"),t=document.getElementById("column-memories"),n=document.getElementById("memoriesList");function o(e){document.querySelectorAll(".sort-memories a i").forEach((e=>e.classList.remove("active"))),e.classList.add("active")}e.addEventListener("click",(function(){n.classList.remove("column-layout"),n.classList.add("grid-layout"),o(e.querySelector("i"))})),t.addEventListener("click",(function(){n.classList.remove("grid-layout"),n.classList.add("column-layout"),o(t.querySelector("i"))}))})),document.addEventListener("DOMContentLoaded",(function(){let e=!1;document.getElementById("show-memory-slideshow").addEventListener("click",(function(){e=!e;const t=this;e?(t.innerHTML="magical memories ▲",document.querySelector(".processing-memories").classList.add("show"),setTimeout((function(){const n=(JSON.parse(localStorage.getItem("memories"))||[]).length,o=document.querySelector(".processing-message");0===n?(o.textContent="You have 0 memories. Please add to see the magic.",setTimeout((()=>{document.querySelector(".processing-memories").classList.remove("show"),t.innerHTML="magical memories ▼",e=!1}),3e3)):n<3?(o.textContent="You need at least 3 memories to see the magic.",setTimeout((()=>{document.querySelector(".processing-memories").classList.remove("show"),t.innerHTML="magical memories ▼",e=!1}),3e3)):(document.querySelector(".processing-memories").classList.remove("show"),document.querySelector(".magical-memories-view").classList.add("show"),animateMemories())}),3e3)):(t.innerHTML="magical memories ▼",document.querySelector(".magical-memories-view").classList.remove("show"),e=!1)}));const t=new THREE.Scene,n=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),o=new THREE.WebGLRenderer({canvas:document.getElementById("myMemories")});o.setSize(window.innerWidth,window.innerHeight);const i=[],a=200,d=100,l=100;function r(e,n,o=!1){const d=window.innerWidth/4+a;e.position.x=d+n*(a+100),t.add(e),i.push(e),o&&(e.userData.hasText=!0)}function c(){const e=window.innerWidth,t=window.innerHeight;n.aspect=e/t,n.updateProjectionMatrix(),o.setSize(e,t);const r=e/4+a;i.forEach(((e,t)=>{e.position.x=r+t*(a+100),e.scale.set(a/200,d/100,l/100)}))}c(),window.addEventListener("resize",c);const s=new THREE.TextureLoader,m=s.load("magic5.png"),u=new THREE.MeshBasicMaterial({map:m});r(new THREE.Mesh(new THREE.BoxGeometry(a,d,l),u),0);r(f("Presents"),1);const p=JSON.parse(localStorage.getItem("myself"));if(p&&p.image){const e=s.load(p.image),t=new THREE.MeshBasicMaterial({map:e});r(new THREE.Mesh(new THREE.BoxGeometry(a,d,l),t),2)}const g=JSON.parse(localStorage.getItem("memories"))||[];g.forEach(((e,t)=>{const n=function(e,t){const n=new THREE.BoxGeometry(a,d,l),o=new THREE.MeshBasicMaterial({color:"blue"}),i=new THREE.Mesh(n,o),r=new THREE.ShaderMaterial({uniforms:{},vertexShader:"\n                    varying vec3 vPos;\n                    void main() {\n                        vPos = position;\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                    }\n                ",fragmentShader:"\n                    varying vec3 vPos;\n                    void main() {\n                        float thickness = 0.02; // Adjust border thickness\n                        vec3 color1 = vec3(0.8, 0.2, 0.2); // Soft Red\n                        vec3 color2 = vec3(0.2, 0.8, 0.2); // Soft Green\n                        vec3 color3 = vec3(0.2, 0.2, 0.8); // Soft Blue\n                        vec3 color4 = vec3(0.8, 0.8, 0.2); // Soft Yellow\n                        vec3 color5 = vec3(0.8, 0.2, 0.8); // Soft Purple\n                        vec3 color = mix(color1, color2, step(0.2, fract(vPos.x * 5.0 + vPos.y * 5.0 + vPos.z * 5.0)));\n                        color = mix(color, color3, step(0.4, fract(vPos.x * 5.0 - vPos.y * 5.0 + vPos.z * 5.0)));\n                        color = mix(color, color4, step(0.6, fract(vPos.x * 5.0 + vPos.y * 5.0 - vPos.z * 5.0)));\n                        color = mix(color, color5, step(0.8, fract(vPos.x * 5.0 - vPos.y * 5.0 - vPos.z * 5.0)));\n                        gl_FragColor = vec4(color, thickness);\n                    }\n                ",side:THREE.BackSide}),c=new THREE.Mesh(n,r);c.scale.multiplyScalar(1.05),i.add(c);const s=f(`${e}`,"bold 72px Comic Sans MS","gold");s.position.y=d/2+10,i.add(s);const m=t.split(" "),u=m.slice(0,20).join(" ")+(m.length>20?"...":""),p=f(u.split("\n").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join("\n"),"bold 72px Comic Sans MS","white");return p.position.y=0,i.add(p),i}(e.title,e.content);r(function(e){const t=new THREE.BoxGeometry(a,d,l),n=new THREE.MeshBasicMaterial({color:"blue"}),o=new THREE.Mesh(t,n),i=new THREE.ShaderMaterial({uniforms:{},vertexShader:"\n                    varying vec3 vPos;\n                    void main() {\n                        vPos = position;\n                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                    }\n                ",fragmentShader:"\n                    varying vec3 vPos;\n                    void main() {\n                        float thickness = 0.02; // Adjust border thickness\n                        vec3 color1 = vec3(0.8, 0.2, 0.8); // Soft Red\n                        vec3 color2 = vec3(0.2, 0.8, 0.2); // Soft Green\n                        vec3 color3 = vec3(0.2, 0.2, 0.8); // Soft Blue\n                        vec3 color4 = vec3(0.8, 0.8, 0.2); // Soft Yellow\n                        vec3 color5 = vec3(0.8, 0.2, 0.8); // Soft Purple\n                        vec3 color = mix(color1, color2, step(0.2, fract(vPos.x * 5.0 + vPos.y * 5.0 + vPos.z * 5.0)));\n                        color = mix(color, color3, step(0.4, fract(vPos.x * 5.0 - vPos.y * 5.0 + vPos.z * 5.0)));\n                        color = mix(color, color4, step(0.6, fract(vPos.x * 5.0 + vPos.y * 5.0 - vPos.z * 5.0)));\n                        color = mix(color, color5, step(0.8, fract(vPos.x * 5.0 - vPos.y * 5.0 - vPos.z * 5.0)));\n                        gl_FragColor = vec4(color, thickness);\n                    }\n                ",side:THREE.BackSide}),r=new THREE.Mesh(t,i);r.scale.multiplyScalar(1.05),o.add(r);const c=f(`${function(e){const t=e.split("/"),n=parseInt(t[1],10),o=parseInt(t[0],10)-1,i=parseInt(t[2],10),a=new Date(i,o,n),d={day:"numeric",month:"long",year:"numeric"},l=a.toLocaleDateString("en-US",d);return l}(e)}`,"bold 72px Comic Sans MS","cyan");return c.position.y=0,o.add(c),o}(e.date),3+2*t),r(n,3+2*t+1,!0)}));const y=s.load("logo.png"),h=new THREE.MeshBasicMaterial({map:y}),E=new THREE.Mesh(new THREE.BoxGeometry(a,d,l),h);function f(e,t="bold 72px Comic Sans MS",n="white"){const o=document.createElement("canvas"),i=o.getContext("2d");o.width=1024,o.height=512,i.clearRect(0,0,o.width,o.height),i.fillStyle=n,i.font=t,i.textAlign="center",i.textBaseline="middle";const r=function(e,t){const n=e.split(" "),o=[];let i="";n.forEach((e=>{if(e.length>t){const n=e.substring(0,t-3)+"...";i.length>0&&(o.push(v(i.trim())),i=""),o.push(n)}else{const n=0===i.length?e:`${i} ${e}`;n.length<=t?i=n:(o.push(v(i.trim())),i=e)}})),i.length>0&&o.push(v(i.trim()));return o}(e,20),c=(o.height-100*r.length)/2;r.forEach(((e,t)=>{i.fillText(e,o.width/2,c+100*t)}));const s=new THREE.CanvasTexture(o);s.minFilter=THREE.LinearFilter,s.magFilter=THREE.LinearFilter,s.wrapS=THREE.ClampToEdgeWrapping,s.wrapT=THREE.ClampToEdgeWrapping;const m=new THREE.MeshBasicMaterial({map:s}),u=new THREE.BoxGeometry(a,d,l);return new THREE.Mesh(u,m)}function v(e){return e.charAt(0).toUpperCase()+e.slice(1)}r(E,3+2*g.length),n.position.z=200;let w=!1,L=null,x=!1,S=0;let T=document.getElementById("default-song"),M=!1,C=0;const b=[{audio:"y2mate.com - How Does A Moment Last Forever  Celine Dion Lyrics.mp3",timeToStart:8},{audio:"y2mate.com - Crystal Skies  Release Me Lyrics feat Gallie Fisher.mp3",timeToStart:23},{audio:"y2mate.com - Diviners  Savannah feat Philly K  Tropical House  NCS  Copyright Free Music.mp3",timeToStart:116},{audio:"y2mate.com - Diviners Riell  Slow Official Lyric Video.mp3",timeToStart:122},{audio:"y2mate.com - Culture Code  Make Me Move feat Karra  Dance Pop  NCS  Copyright Free Music.mp3",timeToStart:120},{audio:"y2mate.com - John Powell  Hans Zimmer  Homeland  Spirit.mp3",timeToStart:212}];function I(){if(L=requestAnimationFrame(I),!w)return;let e=!0;i.forEach((t=>{t.position.x-=.4,t.userData.hasText&&(t.rotation.y+=.004,t.rotation.y*=.95),t.position.x+a/2>0&&(e=!1),t===E&&t.position.x<=0&&!x&&(x=!0,cancelAnimationFrame(L),T.pause(),T.currentTime=0,B.innerHTML=w?"&#9654;":"&#10074;&#10074;",q(),function(){const e=document.getElementById("showOverlayButton");e.style.display="block",e.disabled=!1}())})),o.render(t,n),e&&(x=!1)}const B=document.getElementById("play-memories");function H(){B.innerHTML="&#8635;",cancelAnimationFrame(L),T.pause()}function k(e){const t=document.getElementById("notificationed-container");document.getElementById("notificationed-message").textContent=e,t.classList.add("show"),setTimeout((()=>{t.classList.remove("show")}),6e3)}function R(){const e=document.getElementById("chosen-song").files[0];if(e)T.src=URL.createObjectURL(e),M=!0,k(`Playing... ${e.name}`);else{const e=document.querySelector(".other-songs li.selected");e?(T.src=e.dataset.song,M=!0,k(`Playing... ${e.textContent}`)):(T.src=document.getElementById("default-song").src,M=!1,k("Now playing... "))}T.dataset.currentTime&&(T.currentTime=parseFloat(T.dataset.currentTime),delete T.dataset.currentTime),T.play()}function q(){document.querySelectorAll(".other-songs li").forEach((e=>{e.style.pointerEvents="auto"}))}B.addEventListener("click",(()=>{"&#8635;"===B.innerHTML&&window.location.reload(!0)})),T.addEventListener("stalled",H),T.addEventListener("error",H),T.addEventListener("ended",(()=>{if(k("Audio ended"),w)if(C<b.length){const e=b[C];T.src=e.audio,T.currentTime=e.timeToStart,T.play(),C++,M=!0,k(`Switched to ${e.audio}...`)}else T.src=document.getElementById("default-song").src,T.currentTime=212,T.loop=!0,T.play(),M=!1,k("Switched to default song...");else k("We hoped you enjoyed...")})),T.addEventListener("playing",(()=>{setTimeout("Song Playing...",k,2e3)})),B.addEventListener("click",(()=>{if(w)cancelAnimationFrame(L),T.paused||(T.dataset.currentTime=T.currentTime),T.pause(),B.innerHTML="&#9654;",S=0,q(),w=!1;else{if(x&&(i.forEach(((e,t)=>{const n=window.innerWidth/4+a;e.position.x=n+t*(a+100)+100})),x=!1,0===T.currentTime&&(T.currentTime=0)),I(),S>0){if(performance.now()-S>1)return void H()}S=performance.now(),0===T.currentTime?setTimeout(R,5e3):R(),B.innerHTML="&#10074;&#10074;",e=!0,document.querySelectorAll(".other-songs li").forEach((t=>{t.style.pointerEvents=e?"none":"auto"})),function(){const e=document.getElementById("showOverlayButton");e.style.display="none",e.disabled=!1}(),w=!0}var e})),document.getElementById("chosen-song").addEventListener("change",(()=>{const e=document.getElementById("chosen-song").files[0];if(e){const t=document.querySelector(".other-songs ul"),n=document.createElement("li");n.textContent=e.name,n.dataset.song=URL.createObjectURL(e),n.classList.add("uploaded"),t.appendChild(n),document.querySelectorAll(".other-songs li").forEach((e=>{e.style.pointerEvents=w?"none":"auto"}))}document.querySelector(".othersong-overlay").classList.remove("show")})),document.querySelectorAll(".other-songs li").forEach((e=>{e.addEventListener("click",(()=>{document.querySelectorAll(".other-songs li").forEach((e=>e.classList.remove("selected"))),e.classList.add("selected"),document.querySelector(".othersong-overlay").classList.remove("show")}))})),document.getElementById("closeOtherOverlay").addEventListener("click",(()=>{document.querySelector(".othersong-overlay").classList.remove("show")})),document.getElementById("showOverlayButton").addEventListener("click",(function(){document.querySelector(".othersong-overlay").classList.add("show")}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("magic-friend-about"),t=document.getElementById("closeBtn"),n=document.getElementById("friendImage"),o=document.getElementById("friendName"),i=document.getElementById("friendEmotion"),a=document.getElementById("friendDescription"),d=document.getElementById("characterDisplay");let l="";const r={Joyful:"😊",Grateful:"🙏",Excited:"😃",Inspired:"🌟",Supportive:"🤝",Amused:"😂",Comforted:"🤗",Appreciative:"👍",Lovely:"💖",Cherished:"💝",Happy:"😁"};function c(){const t=JSON.parse(localStorage.getItem("friends")).find((e=>e.name.toLowerCase().includes(l)));if(t){n.src=t.image,o.textContent=t.name;const d=t.emotion.trim().toLowerCase(),l=Object.keys(r).find((e=>e.toLowerCase()===d)),c=l?`${r[l]} ${l}`:"🙂 Just a Friend 🙂";i.innerHTML=`How i feel about ${t.name}<br>${c}`,a.textContent=t.description,e.style.display="flex"}else e.style.display="none"}document.addEventListener("keypress",(t=>{if("INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName){const n=t.key;if("Enter"===n)return l="",d.textContent="",void(e.style.display="none");if(" "===n)return;l+=n.toLowerCase(),d.textContent=l,console.log(l),c()}})),document.addEventListener("keydown",(e=>{"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName&&("Backspace"!==e.key&&"Delete"!==e.key||(l=l.slice(0,-1),d.textContent=l,console.log(l),c()))})),t.addEventListener("click",(()=>{e.style.display="none",l="",d.textContent=""}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("user-image"),t=document.getElementById("myself-name"),n=document.getElementById("my-details"),o=JSON.parse(localStorage.getItem("myself"));o&&(t.textContent=o.name,n.innerHTML=`${o.facebookName}<br>Bio: ${o.bio}`,e.src=o.image||"default-user-image.png")})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("fillFormButton"),t=document.getElementById("storyContent"),n=document.getElementById("overlay-form"),o=document.getElementById("overlay-input"),i=document.getElementById("overlay-select"),a=document.getElementById("saveInputButton"),d=document.getElementById("cancelInputButton"),l=document.getElementById("done-writting");let r=null;const c=JSON.parse(localStorage.getItem("myself")).facebookName;if(c){document.getElementById("get-user-name").textContent=c;document.querySelectorAll(".fetched-user-name").forEach((e=>{e.textContent=c}))}e.addEventListener("click",(function(){t.classList.remove("hidden")})),t.addEventListener("click",(function(e){if(e.target.matches("[data-input], [data-element]")){r=e.target;const t=r.getAttribute("data-input"),a=r.getAttribute("data-element");o.classList.add("hidden"),i.classList.add("hidden"),t?(o.setAttribute("type",t),o.value=r.innerText.trim()||"",o.placeholder=r.id,o.classList.remove("hidden")):"Select"===a&&("country"===r.id?async function(){return fetch("https://restcountries.com/v3.1/all").then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>e.map((e=>e.name.common)).sort().map((e=>`<option value="${e}">${e}</option>`)).join("")))}().then((e=>{console.log("Fetched countries:",e),i.innerHTML=e,i.value=r.innerText.trim()||"",i.classList.remove("hidden")})).catch((e=>{console.error("Error fetching countries:",e)})):"gender"===r.id?(i.innerHTML='\n              <option value="male">Male</option>\n              <option value="female">Female</option>\n            ',i.value=r.innerText.trim()||"",i.classList.remove("hidden")):"possession"===r.id&&(i.innerHTML='\n              <option value="owner">Owner</option>\n              <option value="founder">Founder</option>\n              <option value="cofounder">Co-Founder</option>\n            ',i.value=r.innerText.trim()||"",i.classList.remove("hidden"))),n.style.display="flex"}})),a.addEventListener("click",(function(){if(r){if(o.classList.contains("hidden")){if(!i.classList.contains("hidden")&&(r.innerText=i.value||"[Select]","gender"===r.id)){const e=document.querySelectorAll(".pronoun"),t=i.value.trim();e.forEach((e=>{e.textContent="male"===t?"he":"she"}))}}else r.innerText=o.value||"[Input]";n.style.display="none",!function(){const e=document.querySelectorAll("[data-input]"),t=document.querySelectorAll('[data-element="Select"]');let n=!0;return e.forEach((e=>{""===e.value&&(n=!1)})),t.forEach((e=>{""===e.value&&(n=!1)})),console.log("Inputs:",e),console.log("Selects:",t),console.log("All filled:",n),n}()?l.disabled=!0:l.disabled=!1}})),l.addEventListener("click",(function(){const e=document.querySelector(".story-pedia"),n=document.querySelectorAll("#storyContent p");e.innerHTML="",n.forEach((t=>{const n=t.querySelector("span.fetched-user-name").textContent,o=t.querySelector('span[data-input], span[data-element="Select"]').textContent||"[Value not provided]",i=document.createElement("p");i.textContent=`${n} ${o}.`,e.appendChild(i)})),t.classList.add("hidden"),document.querySelector(".submit-button").classList.add("hidden"),e.classList.remove("hidden")})),d.addEventListener("click",(function(){n.style.display="none"}))}));
